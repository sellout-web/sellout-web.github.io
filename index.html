<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Items for Sale</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
  <style>
  .card-img-top {
    width: 100%;
    height: 150px; /* Set a fixed height for thumbnails */
    object-fit: cover; /* Ensures the image is cropped proportionally */
  }
</style>
  <style>
    .item-card {
      text-align: center;
      margin-bottom: 20px;
    }
    .carousel-img {
      max-height: 400px;
      object-fit: contain;
    }
    .btn-demand {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="text-center mb-4">Items for Sale</h1>
    <div id="items-container" class="row"></div>
  </div>

  <!-- Item Carousel Modal -->
  <div class="modal fade" id="itemModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-body">
          <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
            <div id="carousel-inner" class="carousel-inner"></div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const items = [
      { id: 1, name: "ELC fisher price robot toy", price: "60 QAR", images: ["images/cartoy1.jpeg", "images/cartoy2.jpg", "images/cartoy3.jpg"] },
      { id: 2, name: "ELC Vtech tiny tot driver", price: "60 QAR", images: ["images/drivingtoy1.jpeg", "images/drivingtoy2.jpg", "images/drivingtoy3.jpg", "images/drivingtoy4.jpg"] },
      { id: 3, name: "Ride around car with storage", price: "40 QAR", images: ["images/ridecar1.jpg", "images/ridecar2.jpg", "images/ridecar3.jpeg", "images/ridecar4.jpg", "images/ridecar5.jpg"] },
      { id: 4, name: "Doll house with accessories ", price: "100 QAR", images: ["images/dollHouse1.jpeg", "images/dollHouse2.jpeg"] },
      { id: 5, name: "Set of books", price: "40 QAR", images: ["images/bookSet.jpeg"] },


      { id: 6, name: "Stroller", price: "80 QAR", images: ["images/stroll1.jpeg", "images/stroll2.jpg", "images/stroll3.jpg"] },
      { id: 7, name: "IKEA Cloth Hanger", price: "80 QAR", images: ["images/hanger1.jpeg", "images/hanger2.jpg", "images/hanger3.jpg", "images/hanger4.jpg"] },
      { id: 8, name: "Remote Controlled stand fan", price: "80 QAR", images: ["images/standfan1.jpg", "images/standfan2.jpg"] },
      { id: 9, name: "Turkish Bread basket", price: "20 QAR", images: ["images/tbb1.jpg", "images/tbb2.jpg", "images/tbb3.jpg"] },
      { id: 10, name: "IEKA Plastic basket wooden look", price: "35 QAR", images: ["images/ikeab1.jpg", "images/ikeab2.jpg", "images/ikeab3.jpg", "images/ikeab4.jpg", "images/ikeab5.jpeg"] },
      
      { id: 11, name: "Ikea Glass jug", price: "20 QAR", images: ["images/jug1.jpeg", "images/jug2.jpeg", "images/jug3.jpeg"] },
      
      // Add more items here...
    ];

    


    const loadItems = () => {
      const container = document.getElementById('items-container');
      const storedDemand = JSON.parse(localStorage.getItem('itemDemand')) || {};
      
      items.forEach(item => {
        if (!storedDemand[item.id]) storedDemand[item.id] = 0;
      });

      // Sort items by demand
      items.sort((a, b) => (storedDemand[b.id] || 0) - (storedDemand[a.id] || 0));

      // Update DOM
      container.innerHTML = '';
      items.forEach(item => {
        container.innerHTML += `
          <div class="col-12 col-sm-6 col-md-4 col-lg-3">
            <div class="card item-card">
              <img src="${item.images[0]}" class="card-img-top" alt="${item.name}" style="cursor:pointer;" onclick="openCarousel(${item.id})">
              <div class="card-body">
                <h5 class="card-title">${item.name}</h5>
                <p class="card-text">${item.price}</p>
                <a href="https://wa.me/97466081840?text=I am interested in ${item.name}" class="btn btn-success d-block mb-2" target="_blank">Contact on WhatsApp</a>
                <button class="btn btn-primary btn-demand" onclick="incrementDemand(${item.id})">
                  I want this <span class="badge bg-light text-dark ms-2">${storedDemand[item.id]}</span>
                </button>
              </div>
            </div>
          </div>
        `;
      });
      localStorage.setItem('itemDemand', JSON.stringify(storedDemand));
    };

    const openCarousel = (itemId) => {
  const item = items.find(i => i.id === itemId);
  const carouselInner = document.getElementById('carousel-inner');
  carouselInner.innerHTML = '';

  item.images.forEach((img, idx) => {
    carouselInner.innerHTML += `
      <div class="carousel-item ${idx === 0 ? 'active' : ''}">
        <img src="${img}" class="d-block w-100 carousel-img" alt="${item.name}">
      </div>
    `;
  });

  const modal = new bootstrap.Modal(document.getElementById('itemModal'));
  modal.show();

  // Add keyboard navigation for the carousel
  document.addEventListener('keydown', handleCarouselKey);
};

// Function to handle left/right arrow keys for carousel navigation
const handleCarouselKey = (event) => {
  const carousel = document.getElementById('carouselExample');
  if (event.key === 'ArrowLeft') {
    carousel.querySelector('.carousel-control-prev').click();
  } else if (event.key === 'ArrowRight') {
    carousel.querySelector('.carousel-control-next').click();
  }
};

    const incrementDemand = (itemId) => {
      const storedDemand = JSON.parse(localStorage.getItem('itemDemand')) || {};
      storedDemand[itemId] = (storedDemand[itemId] || 0) + 1;
      localStorage.setItem('itemDemand', JSON.stringify(storedDemand));
      loadItems();
    };

    document.addEventListener('DOMContentLoaded', loadItems);

    // Remove the event listener when modal is closed
document.getElementById('itemModal').addEventListener('hidden.bs.modal', () => {
  document.removeEventListener('keydown', handleCarouselKey);
});

  </script>

  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
  ></script>


</body>
</html>
